<main>
<!--********************************************************************
                        Patient Search Field
**********************************************************************-->
  <h2>Add or Lookup Patient</h2>
  <form [formGroup]="patientForm" (ngSubmit)="onSubmit()">

    <div class="patient-form-group">
      <mat-form-field class="example-full-width" appearance="outline">
        <mat-label>Patient Identifier</mat-label>
        <input type="text"
        placeholder="1234"
        aria-label="Patient Identifier"
        matInput
        formControlName="patientIdentifier">
        <mat-error *ngIf="f.patientIdentifier.errors?.required">This field is required.</mat-error>
        <mat-error *ngIf="f.patientIdentifier.errors?.minlength || f.patientIdentifier.errors?.maxlength">ID should be 4-5 digits.</mat-error>
      </mat-form-field>

      <button class="form-btn"
              mat-raised-button
              color="primary"
              [disabled]="f.patientIdentifier.invalid"
              *ngIf="!displayPatientForm"
              (click)="searchPatientIdentifier()">Next</button>
    </div>

  <!--********************************************************************
                          Patient Detail Form
  **********************************************************************-->
    <div class="patient-form-group" *ngIf="displayPatientForm">
      <mat-form-field appearance="outline">
        <mat-label>First Name</mat-label>
        <input matInput
              type="text"
              formControlName="firstName"
              aria-label="First Name"
              placeholder="Jane">
        <mat-error *ngIf="f.firstName.errors?.required">This field is required.</mat-error>
      </mat-form-field>
      <mat-form-field appearance="outline">
        <mat-label>Last Name</mat-label>
        <input matInput
               type="text"
               formControlName="lastName"
               aria-label="Last Name"
               placeholder="Doe">
        <mat-error *ngIf="f.lastName.errors?.required">This field is required.</mat-error>
      </mat-form-field>
      <mat-form-field appearance="outline">
        <mat-label>Phone Number</mat-label>
        <input matInput
               type="text"
               formControlName="phone"
               mask="(000) 000-0000"
               aria-label="Phone Number"
               placeholder="Phone Number">
        <mat-error *ngIf="f.phone.errors?.required">This field is required.</mat-error>
      </mat-form-field>
      <mat-checkbox formControlName="isMinor"
                    aria-label="Minor">Minor?</mat-checkbox>
      <mat-form-field appearance="outline">
        <mat-label>Preferred Language</mat-label>
        <mat-select placeholder="Language"
                    aria-label="Preferred Language"
                    formControlName="preferredLanguage">
          <mat-option *ngFor="let l of languages" [value]="l">
            {{ l }}
          </mat-option>
        </mat-select>
        <mat-error *ngIf="f.preferredLanguage.errors?.required">This field is required.</mat-error>
      </mat-form-field>
      <mat-form-field appearance="outline">
        <mat-label>Preferred Contact Method</mat-label>
        <mat-select placeholder="Contact Method"
                    aria-label="Preferred Contact Method"
                    formControlName="preferredContactMethod">
          <mat-option *ngFor="let c of contactMethods" [value]="c.value">
            {{ c.displayValue }}
          </mat-option>
        </mat-select>
        <mat-error *ngIf="f.preferredContactMethod.errors?.required">This field is required.</mat-error>
      </mat-form-field>
      <button class="form-btn"
              mat-raised-button
              color="primary"
              type="submit"
              [disabled]="!patientForm.valid">Next</button>
      <button mat-raised-button
              color="warn"
              class="form-btn"
              (click)="handleCancelClick()">Cancel</button>
    </div>
  </form>

  <!--********************************************************************
                              Form Debug
  **********************************************************************-->
  <div class="debug">
    <p>Form Status: {{ patientForm.status }}</p>
    <p>Form Value: {{ patientForm.value | json }}</p>
  </div>
</main>

<!--********************************************************************
                            Patient Modal
**********************************************************************-->
<div *ngIf="displayPatientFoundModal" class="modal">
  <div class="modal-content">
    <h2>Found Matching Patient: {{ existingPatient.firstName }} {{ existingPatient.lastName }}</h2>
    <p>Is this your patient?</p>
    <div class="modal-ctrl-btns">
      <button mat-raised-button
              color="primary"
              (click)="handleYesClick()">Yes</button>
      <button mat-raised-button
              color="accent"
              (click)="handleNoClick()">No</button>
    </div>
  </div>
</div>
